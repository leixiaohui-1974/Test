# 明渠边坡稳定性监测预测系统技术方案

## 系统概述

本系统针对高地下水位段明渠边坡衬砌板稳定性监测预测问题，开发了一套完整的数值仿真和降阶模型解决方案。系统集成了水动力学模拟、水质模拟和边坡稳定性分析三大模块，能够精准仿真明渠水力学过程及其边坡衬砌板的稳定性过程。

### 核心特性

1. **精细化物理模型**
   - 基于Preissmann隐式格式的非恒定流模拟
   - 对流-扩散-反应方程的水质模拟
   - 基于极限平衡理论的边坡稳定性分析
   - 自适应断面划分功能

2. **降阶模型**
   - 线性化降阶：ID模型（水动力）+ 线性对流扩散（水质）+ 线性响应（边坡）
   - 深度学习降阶：LSTM/Transformer神经网络

3. **监测网络集成**
   - 地下水观测井（每500m）
   - 渠道两端雨量计和水位计
   - 多源数据融合

## 系统架构

### 1. 工程场景

- **明渠长度**: 20 km
- **地下水观测井**: 每500m一个，共41个观测井
- **边界监测**: 渠道两端各有雨量计和水位计
- **断面建模**: 每个观测井断面独立建模
- **衬砌板稳定性影响因素**:
  - 降雨强度
  - 地下水位
  - 渠道水位（通过水力学模型计算）
  - 土壤物理特性

### 2. 模块设计

```
channel_stability/
├── core/                          # 核心数据结构
│   ├── channel_system.py         # 明渠系统、断面、土壤、衬砌特性
│   └── monitoring_network.py     # 监测网络、监测站
│
├── hydrodynamics/                 # 水动力学模块
│   ├── preissmann_solver.py     # Preissmann隐式求解器
│   ├── adaptive_mesh.py          # 自适应断面划分
│   └── boundary_conditions.py    # 边界条件
│
├── water_quality/                 # 水质模拟模块
│   ├── advection_diffusion_solver.py  # 对流-扩散-反应求解器
│   └── reaction_kinetics.py      # 反应动力学（DO, BOD, NH3-N, TN, TP等）
│
├── slope_stability/               # 边坡稳定性模块
│   ├── stability_calculator.py   # 稳定性计算器
│   └── failure_mechanisms.py     # 失稳机理（滑动、倾覆、浮托、渗透）
│
├── reduced_order/                 # 降阶模型
│   ├── linear_reduced_model.py   # 线性化降阶
│   └── deep_learning_model.py    # 深度学习降阶
│
└── integrated_simulation.py       # 综合仿真系统
```

## 数学模型

### 1. 水动力学模型（Preissmann方法）

#### 圣维南方程组

**连续性方程**:
```
∂A/∂t + ∂Q/∂x = 0
```

**动量方程**:
```
∂Q/∂t + ∂(Q²/A)/∂x + gA∂h/∂x + gASf = 0
```

其中：
- A: 过流断面积
- Q: 流量
- h: 水位
- g: 重力加速度
- Sf: 摩阻坡度（Manning公式）

#### Preissmann离散格式

时间权重系数 θ = 0.7（介于Crank-Nicolson和全隐式之间）:

```
θ·f(t^(n+1)) + (1-θ)·f(t^n)
```

Picard迭代求解非线性方程组。

#### 自适应断面划分

根据以下指标自适应调整计算断面：
- 水深梯度: |∂h/∂x|
- 流速梯度: |∂u/∂x|
- Froude数: Fr = u/√(gA/B)

### 2. 水质模拟模型

#### 对流-扩散-反应方程

```
∂C/∂t + u·∂C/∂x = D·∂²C/∂x² + R(C)
```

其中：
- C: 污染物浓度
- u: 流速
- D: 纵向离散系数
- R(C): 反应源项

#### 支持的水质指标

1. **DO (溶解氧)**:
   ```
   R_DO = k_reaeration(C_sat - C_DO) - k_BOD·C_BOD
   ```

2. **BOD (生化需氧量)**:
   ```
   R_BOD = -k_BOD·C_BOD
   ```

3. **NH3-N (氨氮)**:
   ```
   R_NH3N = -k_nitrification·C_NH3N·f(DO)
   ```

4. **TN (总氮)**:
   ```
   R_TN = -k_denitrification·C_TN·f(DO) - k_settling·C_TN
   ```

5. **TP (总磷)**:
   ```
   R_TP = -k_settling·C_TP
   ```

### 3. 边坡稳定性模型

#### 失稳模式

系统考虑四种失稳模式：

1. **滑动失稳**
   ```
   F_sliding = (c·L + N·tan(φ)) / T
   ```
   其中：
   - c: 土体粘聚力
   - φ: 内摩擦角
   - N: 有效正压力
   - T: 下滑力

2. **倾覆失稳**
   ```
   F_overturning = M_resisting / M_overturning
   ```

3. **浮托失稳**
   ```
   F_uplift = W_total / U
   ```
   其中：
   - W_total: 总重量
   - U: 浮托力

4. **渗透失稳**
   ```
   F_seepage = i_critical / i
   ```
   其中：
   - i_critical: 临界水力梯度
   - i: 实际水力梯度

#### 综合稳定性评估

采用最小值法：
```
F_comprehensive = min(F_sliding, F_overturning, F_uplift, F_seepage)
```

安全阈值：
- 抗滑稳定系数 ≥ 1.3
- 抗倾覆稳定系数 ≥ 1.5
- 抗浮稳定系数 ≥ 1.2
- 渗透稳定系数 ≥ 1.5

### 4. 降阶模型

#### 4.1 线性化降阶

**ID模型（水动力）**:

基于线性化圣维南方程的瞬态演进模型，假设流量和水深的局部线性关系：
```
h = h₀ + Δh
Q = Q₀ + ΔQ
```

运动波近似：
```
∂h/∂t + c·∂h/∂x + k·h = 0
```
其中 c 为波速，k 为摩阻系数。

**线性水质模型**:

线性对流-扩散-衰减方程：
```
∂C/∂t + u₀·∂C/∂x = D·∂²C/∂x² - k·C
```

**线性边坡稳定性模型**:

基于线性响应假设：
```
F = F₀ + k_gw·Δh_gw + k_ch·Δh_ch + k_rain·ΔR
```
其中：
- F₀: 基准稳定系数
- k_gw: 地下水位敏感系数
- k_ch: 渠道水位敏感系数
- k_rain: 降雨敏感系数

#### 4.2 深度学习降阶

**LSTM网络**:

```
输入: [上游流量, 地下水位, 降雨强度]_{t-n:t}
输出: [水深, 水质浓度, 稳定系数]_{t+1:t+m}
```

网络结构：
- 输入层: 3个特征
- LSTM层: 2层，隐藏层大小64
- 全连接层: 输出3个目标变量

**Transformer网络**:

基于自注意力机制的序列预测模型：
- 编码器层数: 2
- 注意力头数: 4
- 模型维度: 64
- 前馈网络维度: 256

## 使用指南

### 安装依赖

```bash
pip install numpy scipy matplotlib
# 可选：深度学习模型
pip install torch
```

### 快速开始

```python
from channel_stability import IntegratedSimulator
from channel_stability.core.channel_system import ChannelSystem
from channel_stability.core.monitoring_network import MonitoringNetwork
from channel_stability.hydrodynamics.boundary_conditions import BoundaryConditions

# 1. 创建明渠系统
channel = ChannelSystem(
    name="示例明渠",
    total_length=20000.0,  # 20 km
    sections=[],
)

# 2. 创建监测网络
monitoring_network = MonitoringNetwork(
    network_name="监测网络"
)
monitoring_network.create_uniform_groundwater_network(
    channel_length=20000.0,
    spacing=500.0,  # 每500m一个观测井
)

# 3. 定义边界条件
bc = BoundaryConditions.create_constant_bc(
    upstream_q=10.0,  # 上游流量
    downstream_h=2.5,  # 下游水位
)

# 4. 创建仿真器
simulator = IntegratedSimulator(
    channel=channel,
    monitoring_network=monitoring_network,
    boundary_conditions=bc,
)

# 5. 运行仿真
results = simulator.run_simulation()

# 6. 导出结果
simulator.export_results(results, "output_dir")
```

### 运行示例

```bash
cd examples
python channel_stability_example.py
```

## 系统特色

### 1. 独立断面建模

系统假设各个断面的稳定性独立计算，这种简化方法：
- **优点**: 计算效率高，易于并行化
- **适用场景**: 渠道较长，断面间距较大
- **综合评估**: 通过统计所有断面的稳定性指标，给出全渠道的综合评估

### 2. 定量化稳定性评估

系统提供多层次的定量化稳定性指标：

- **断面级**: 各失稳模式的安全系数
- **时间序列**: 稳定性随时间的演化
- **空间分布**: 沿程稳定性变化
- **全渠道指标**: 综合稳定性指数、不稳定断面数量

### 3. 多模型协同

精细化模型与降阶模型协同工作：
- **精细化模型**: 用于详细分析和离线计算
- **降阶模型**: 用于实时预测和快速决策
- **模型校准**: 使用精细化模型结果训练降阶模型

## 输出结果

### 1. 水动力学结果
- 时空分布的水深、流量、流速
- Froude数分布
- 水位变化过程

### 2. 水质结果
- DO, BOD, NH3-N, TN, TP等指标的时空分布
- 浓度变化过程
- 污染物迁移轨迹

### 3. 边坡稳定性结果
- 各断面的稳定性系数历史
- 不稳定断面识别
- 全渠道综合稳定性指标
- 预警信息

### 4. 可视化
- 水深剖面图
- 水质浓度分布图
- 稳定性系数分布图
- 时间序列曲线

## 技术优势

1. **模型精度高**: 采用隐式格式，稳定性好，适用于各种流态
2. **自适应网格**: 自动加密高梯度区域，提高计算效率
3. **多物理场耦合**: 水动力-水质-边坡稳定性全耦合
4. **实用性强**: 考虑实际工程中的监测数据和边界条件
5. **可扩展性**: 模块化设计，易于扩展新功能

## 应用场景

1. **工程设计**: 明渠边坡衬砌设计优化
2. **安全监测**: 实时监测边坡稳定性
3. **风险评估**: 不同工况下的稳定性评估
4. **预警系统**: 基于降阶模型的快速预警
5. **科研教学**: 水力学和边坡工程教学演示

## 未来改进方向

1. **三维模型**: 考虑横向流动和三维边坡效应
2. **流固耦合**: 土体-衬砌-水流的全耦合分析
3. **不确定性分析**: 参数不确定性和风险概率评估
4. **智能优化**: 基于AI的设计优化和决策支持
5. **实时数据同化**: 结合实时监测数据更新模型

## 参考文献

1. Preissmann, A. (1961). Propagation des intumescences dans les canaux et rivières.
2. Toro, E. F. (2001). Shock-capturing methods for free-surface shallow flows.
3. Bishop, A. W. (1955). The use of the slip circle in the stability analysis of slopes.
4. Fredlund, D. G., & Rahardjo, H. (1993). Soil mechanics for unsaturated soils.

## 联系方式

如有技术问题或合作需求，请联系开发团队。

---

**版本**: 1.0.0  
**最后更新**: 2025-10-27
